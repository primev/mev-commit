apiVersion: batch/v1
kind: Job
metadata:
  name: fix-timestamps-smart  
  namespace: default
spec:
  backoffLimit: 0
  template:
    spec:
      restartPolicy: Never
      containers:
      - name: fix
        image: golang:1.21
        command:
        - /bin/bash
        - -c
        - |
          set -e
          mkdir -p /app && cd /app
          echo 'cGFja2FnZSBtYWluCgppbXBvcnQgKAoJImJ5dGVzIgoJImNvbnRleHQiCgkiZGF0YWJhc2Uvc3FsIgoJImVuY29kaW5nL2pzb24iCgkiZmxhZyIKCSJmbXQiCgkiaW8iCgkibG9nIgoJIm5ldC9odHRwIgoJInN0cmNvbnYiCgkic3RyaW5ncyIKCSJzeW5jIgoJInRpbWUiCgoJXyAiZ2l0aHViLmNvbS9nby1zcWwtZHJpdmVyL215c3FsIgopCgp0eXBlIEJsb2NrVXBkYXRlIHN0cnVjdCB7CglOdW1iZXIgICAgaW50NjQKCVRpbWVzdGFtcCBpbnQ2NAoJSGFzaCAgICAgIHN0cmluZwp9Cgp0eXBlIFJQQ1JlcXVlc3Qgc3RydWN0IHsKCUpTT05SUEMgc3RyaW5nICAgICAgICBganNvbjoianNvbnJwYyJgCglNZXRob2QgIHN0cmluZyAgICAgICAgYGpzb246Im1ldGhvZCJgCglQYXJhbXMgIFtdaW50ZXJmYWNle30gYGpzb246InBhcmFtcyJgCglJRCAgICAgIGludCAgICAgICAgICAgYGpzb246ImlkImAKfQoKdHlwZSBSUENSZXNwb25zZSBzdHJ1Y3QgewoJSlNPTlJQQyBzdHJpbmcgICAgICAgICAgYGpzb246Impzb25ycGMiYAoJSUQgICAgICBpbnQgICAgICAgICAgICAgYGpzb246ImlkImAKCVJlc3VsdCAganNvbi5SYXdNZXNzYWdlIGBqc29uOiJyZXN1bHQiYAoJRXJyb3IgICAqUlBDRXJyb3IgICAgICAgYGpzb246ImVycm9yLG9taXRlbXB0eSJgCn0KCnR5cGUgUlBDRXJyb3Igc3RydWN0IHsKCUNvZGUgICAgaW50ICAgIGBqc29uOiJjb2RlImAKCU1lc3NhZ2Ugc3RyaW5nIGBqc29uOiJtZXNzYWdlImAKfQoKdHlwZSBCbG9ja1Jlc3VsdCBzdHJ1Y3QgewoJTnVtYmVyICAgIHN0cmluZyBganNvbjoibnVtYmVyImAKCVRpbWVzdGFtcCBzdHJpbmcgYGpzb246InRpbWVzdGFtcCJgCglIYXNoICAgICAgc3RyaW5nIGBqc29uOiJoYXNoImAKfQoKdmFyICgKCXZlcnNpb25FcnJvckNvdW50IGludDY0Cgl2ZXJzaW9uRXJyb3JNdSAgICBzeW5jLk11dGV4CglsYXN0Q29tcGFjdFRpbWUgICB0aW1lLlRpbWUKKQoKZnVuYyBtYWluKCkgewoJcnBjVVJMIDo9IGZsYWcuU3RyaW5nKCJycGMiLCAiaHR0cHM6Ly9jaGFpbnJwYy12MS5tZXYtY29tbWl0Lnh5eiIsICJSUEMgZW5kcG9pbnQgVVJMIikKCWRzbiA6PSBmbGFnLlN0cmluZygiZHNuIiwgIiIsICJEYXRhYmFzZSBEU04gKHJlcXVpcmVkKSIpCgliYXRjaFNpemUgOj0gZmxhZy5JbnQoImJhdGNoLXNpemUiLCAxMDAwLCAiTnVtYmVyIG9mIGJsb2NrcyBwZXIgYmF0Y2giKQoJd29ya2VycyA6PSBmbGFnLkludCgid29ya2VycyIsIDE1LCAiTnVtYmVyIG9mIGNvbmN1cnJlbnQgUlBDIHdvcmtlcnMiKQoJZHJ5UnVuIDo9IGZsYWcuQm9vbCgiZHJ5LXJ1biIsIGZhbHNlLCAiRHJ5IHJ1biBtb2RlIChkb24ndCB1cGRhdGUgZGF0YWJhc2UpIikKCXN0YXJ0QmxvY2sgOj0gZmxhZy5JbnQ2NCgic3RhcnQtYmxvY2siLCAwLCAiU3RhcnQgYmxvY2sgbnVtYmVyIChvcHRpb25hbCkiKQoJZW5kQmxvY2sgOj0gZmxhZy5JbnQ2NCgiZW5kLWJsb2NrIiwgLTEsICJFbmQgYmxvY2sgbnVtYmVyIChvcHRpb25hbCwgLTEgZm9yIGFsbCkiKQoJZmxhZy5QYXJzZSgpCgoJaWYgKmRzbiA9PSAiIiB7CgkJbG9nLkZhdGFsKCItLWRzbiBpcyByZXF1aXJlZCIpCgl9CgoJbG9nLlByaW50ZigiU3RhcnRpbmcgU01BUlQgdGltZXN0YW1wIGZpeCAoUkVWRVJTRSBPUkRFUiB3aXRoIGF1dG8tcGF1c2UpIikKCWxvZy5QcmludGYoIlJQQzogJXMiLCAqcnBjVVJMKQoJbG9nLlByaW50ZigiQmF0Y2ggc2l6ZTogJWQgYmxvY2tzIHBlciBiYXRjaCIsICpiYXRjaFNpemUpCglsb2cuUHJpbnRmKCJXb3JrZXJzOiAlZCIsICp3b3JrZXJzKQoJbG9nLlByaW50ZigiRHJ5IHJ1bjogJXYiLCAqZHJ5UnVuKQoKCS8vIENvbm5lY3QgdG8gZGF0YWJhc2UKCWRiLCBlcnIgOj0gc3FsLk9wZW4oIm15c3FsIiwgKmRzbikKCWlmIGVyciAhPSBuaWwgewoJCWxvZy5GYXRhbGYoIkZhaWxlZCB0byBjb25uZWN0IHRvIGRhdGFiYXNlOiAldiIsIGVycikKCX0KCWRlZmVyIGRiLkNsb3NlKCkKCgkvLyBHZXQgYmxvY2sgcmFuZ2UKCXZhciBtaW5CbG9jaywgbWF4QmxvY2sgaW50NjQKCXF1ZXJ5IDo9ICJTRUxFQ1QgTUlOKG51bWJlciksIE1BWChudW1iZXIpIEZST00gYmxvY2tzIgoJaWYgZXJyIDo9IGRiLlF1ZXJ5Um93KHF1ZXJ5KS5TY2FuKCZtaW5CbG9jaywgJm1heEJsb2NrKTsgZXJyICE9IG5pbCB7CgkJbG9nLkZhdGFsZigiRmFpbGVkIHRvIGdldCBibG9jayByYW5nZTogJXYiLCBlcnIpCgl9CgoJaWYgKnN0YXJ0QmxvY2sgPiAwIHsKCQltaW5CbG9jayA9ICpzdGFydEJsb2NrCgl9CglpZiAqZW5kQmxvY2sgPj0gMCAmJiAqZW5kQmxvY2sgPCBtYXhCbG9jayB7CgkJbWF4QmxvY2sgPSAqZW5kQmxvY2sKCX0KCglsb2cuUHJpbnRmKCJCbG9jayByYW5nZTogJWQgRE9XTiBUTyAlZCAodG90YWw6ICVkIGJsb2NrcykgLSBORVdFU1QgRklSU1QiLCBtYXhCbG9jaywgbWluQmxvY2ssIG1heEJsb2NrLW1pbkJsb2NrKzEpCgoJY3R4IDo9IGNvbnRleHQuQmFja2dyb3VuZCgpCglsYXN0Q29tcGFjdFRpbWUgPSB0aW1lLk5vdygpCgoJLy8gQ2hhbm5lbHMKCWJsb2NrQ2hhbiA6PSBtYWtlKGNoYW4gaW50NjQsICp3b3JrZXJzKjIpCglyZXN1bHRDaGFuIDo9IG1ha2UoY2hhbiBCbG9ja1VwZGF0ZSwgKmJhdGNoU2l6ZSoyKQoKCXZhciB3ZyBzeW5jLldhaXRHcm91cAoKCS8vIFN0YXRzCgl2YXIgKAoJCXRvdGFsRmV0Y2hlZCBpbnQ2NAoJCXRvdGFsVXBkYXRlZCBpbnQ2NAoJCXRvdGFsU2tpcHBlZCBpbnQ2NAoJCXRvdGFsRXJyb3JzICBpbnQ2NAoJCW11ICAgICAgICAgICBzeW5jLk11dGV4CgkpCgoJLy8gVHJhY2sgc3VjY2Vzc2Z1bGx5IHVwZGF0ZWQgYmxvY2tzCgl1cGRhdGVkQmxvY2tzIDo9IG1ha2UobWFwW2ludDY0XWJvb2wpCgl2YXIgdXBkYXRlZE11IHN5bmMuTXV0ZXgKCgkvLyBTdGFydCBSUEMgd29ya2VycwoJZm9yIGkgOj0gMDsgaSA8ICp3b3JrZXJzOyBpKysgewoJCXdnLkFkZCgxKQoJCWdvIGZ1bmMod29ya2VySUQgaW50KSB7CgkJCWRlZmVyIHdnLkRvbmUoKQoJCQljbGllbnQgOj0gJmh0dHAuQ2xpZW50e1RpbWVvdXQ6IDMwICogdGltZS5TZWNvbmR9CgoJCQlmb3IgYmxvY2tOdW0gOj0gcmFuZ2UgYmxvY2tDaGFuIHsKCQkJCS8vIENoZWNrIGlmIGFscmVhZHkgdXBkYXRlZAoJCQkJdXBkYXRlZE11LkxvY2soKQoJCQkJaWYgdXBkYXRlZEJsb2Nrc1tibG9ja051bV0gewoJCQkJCXVwZGF0ZWRNdS5VbmxvY2soKQoJCQkJCW11LkxvY2soKQoJCQkJCXRvdGFsU2tpcHBlZCsrCgkJCQkJbXUuVW5sb2NrKCkKCQkJCQljb250aW51ZQoJCQkJfQoJCQkJdXBkYXRlZE11LlVubG9jaygpCgoJCQkJY29ycmVjdFRpbWVzdGFtcCwgYmxvY2tIYXNoLCBlcnIgOj0gZmV0Y2hCbG9ja1RpbWVzdGFtcChjbGllbnQsICpycGNVUkwsIGJsb2NrTnVtKQoJCQkJaWYgZXJyICE9IG5pbCB7CgkJCQkJbG9nLlByaW50ZigiW1dvcmtlciAlZF0gRXJyb3IgZmV0Y2hpbmcgYmxvY2sgJWQ6ICV2Iiwgd29ya2VySUQsIGJsb2NrTnVtLCBlcnIpCgkJCQkJbXUuTG9jaygpCgkJCQkJdG90YWxFcnJvcnMrKwoJCQkJCW11LlVubG9jaygpCgkJCQkJY29udGludWUKCQkJCX0KCgkJCQlyZXN1bHRDaGFuIDwtIEJsb2NrVXBkYXRlewoJCQkJCU51bWJlcjogICAgYmxvY2tOdW0sCgkJCQkJVGltZXN0YW1wOiBjb3JyZWN0VGltZXN0YW1wLAoJCQkJCUhhc2g6ICAgICAgYmxvY2tIYXNoLAoJCQkJfQoKCQkJCW11LkxvY2soKQoJCQkJdG90YWxGZXRjaGVkKysKCQkJCW11LlVubG9jaygpCgkJCX0KCQl9KGkpCgl9CgoJLy8gU3RhcnQgYmF0Y2ggdXBkYXRlcgoJdmFyIHVwZGF0ZVdnIHN5bmMuV2FpdEdyb3VwCgl1cGRhdGVXZy5BZGQoMSkKCWdvIGZ1bmMoKSB7CgkJZGVmZXIgdXBkYXRlV2cuRG9uZSgpCgoJCWJhdGNoIDo9IG1ha2UoW11CbG9ja1VwZGF0ZSwgMCwgKmJhdGNoU2l6ZSkKCQlsYXN0VXBkYXRlIDo9IHRpbWUuTm93KCkKCgkJZm9yIHVwZGF0ZSA6PSByYW5nZSByZXN1bHRDaGFuIHsKCQkJYmF0Y2ggPSBhcHBlbmQoYmF0Y2gsIHVwZGF0ZSkKCgkJCS8vIEZsdXNoIGJhdGNoIHdoZW4gZnVsbCBvciBldmVyeSA1IHNlY29uZHMKCQkJaWYgbGVuKGJhdGNoKSA+PSAqYmF0Y2hTaXplIHx8IHRpbWUuU2luY2UobGFzdFVwZGF0ZSkgPiA1KnRpbWUuU2Vjb25kIHsKCQkJCWlmICEqZHJ5UnVuICYmIGxlbihiYXRjaCkgPiAwIHsKCQkJCQl1cGRhdGVkLCBzdWNjZXNzQmxvY2tzIDo9IGJhdGNoVXBkYXRlQmxvY2tzKGN0eCwgZGIsIGJhdGNoKQoKCQkJCQkvLyBNYXJrIHN1Y2Nlc3NmdWxseSB1cGRhdGVkIGJsb2NrcwoJCQkJCXVwZGF0ZWRNdS5Mb2NrKCkKCQkJCQlmb3IgXywgYmxvY2tOdW0gOj0gcmFuZ2Ugc3VjY2Vzc0Jsb2NrcyB7CgkJCQkJCXVwZGF0ZWRCbG9ja3NbYmxvY2tOdW1dID0gdHJ1ZQoJCQkJCX0KCQkJCQl1cGRhdGVkTXUuVW5sb2NrKCkKCgkJCQkJbXUuTG9jaygpCgkJCQkJdG90YWxVcGRhdGVkICs9IGludDY0KHVwZGF0ZWQpCgkJCQkJbXUuVW5sb2NrKCkKCgkJCQkJbG9nLlByaW50ZigiUHJvZ3Jlc3M6ICVkIGZldGNoZWQsICVkIHVwZGF0ZWQsICVkIHNraXBwZWQsICVkIGVycm9ycyAtIEJhdGNoOiAlZCBibG9ja3MgKHJhbmdlOiAlZCB0byAlZCkiLAoJCQkJCQl0b3RhbEZldGNoZWQsIHRvdGFsVXBkYXRlZCwgdG90YWxTa2lwcGVkLCB0b3RhbEVycm9ycywgbGVuKGJhdGNoKSwgYmF0Y2hbbGVuKGJhdGNoKS0xXS5OdW1iZXIsIGJhdGNoWzBdLk51bWJlcikKCQkJCX0KCQkJCWJhdGNoID0gYmF0Y2hbOjBdCgkJCQlsYXN0VXBkYXRlID0gdGltZS5Ob3coKQoJCQl9CgkJfQoKCQkvLyBGaW5hbCBmbHVzaAoJCWlmICEqZHJ5UnVuICYmIGxlbihiYXRjaCkgPiAwIHsKCQkJdXBkYXRlZCwgXyA6PSBiYXRjaFVwZGF0ZUJsb2NrcyhjdHgsIGRiLCBiYXRjaCkKCQkJbXUuTG9jaygpCgkJCXRvdGFsVXBkYXRlZCArPSBpbnQ2NCh1cGRhdGVkKQoJCQltdS5VbmxvY2soKQoJCQlsb2cuUHJpbnRmKCJGaW5hbCBiYXRjaDogJWQgYmxvY2tzIHVwZGF0ZWQiLCB1cGRhdGVkKQoJCX0KCX0oKQoKCS8vIEZlZWQgYmxvY2tzIHRvIHdvcmtlcnMgSU4gUkVWRVJTRSBPUkRFUiAobWF4IHRvIG1pbikKCXN0YXJ0VGltZSA6PSB0aW1lLk5vdygpCglnbyBmdW5jKCkgewoJCWZvciBibG9ja051bSA6PSBtYXhCbG9jazsgYmxvY2tOdW0gPj0gbWluQmxvY2s7IGJsb2NrTnVtLS0gewoJCQlibG9ja0NoYW4gPC0gYmxvY2tOdW0KCQl9CgkJY2xvc2UoYmxvY2tDaGFuKQoJfSgpCgoJLy8gV2FpdCBmb3IgUlBDIHdvcmtlcnMKCXdnLldhaXQoKQoJY2xvc2UocmVzdWx0Q2hhbikKCgkvLyBXYWl0IGZvciB1cGRhdGVyCgl1cGRhdGVXZy5XYWl0KCkKCgllbGFwc2VkIDo9IHRpbWUuU2luY2Uoc3RhcnRUaW1lKQoKCWxvZy5QcmludGYoIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iKQoJbG9nLlByaW50ZigiVGltZXN0YW1wIGZpeCBjb21wbGV0ZWQhIikKCWxvZy5QcmludGYoIlRvdGFsIGZldGNoZWQ6ICVkIiwgdG90YWxGZXRjaGVkKQoJbG9nLlByaW50ZigiVG90YWwgdXBkYXRlZDogJWQiLCB0b3RhbFVwZGF0ZWQpCglsb2cuUHJpbnRmKCJUb3RhbCBza2lwcGVkOiAlZCIsIHRvdGFsU2tpcHBlZCkKCWxvZy5QcmludGYoIlRvdGFsIGVycm9yczogJWQiLCB0b3RhbEVycm9ycykKCWxvZy5QcmludGYoIkR1cmF0aW9uOiAldiIsIGVsYXBzZWQpCglpZiBlbGFwc2VkLlNlY29uZHMoKSA+IDAgewoJCWxvZy5QcmludGYoIlJhdGU6ICUuMmYgYmxvY2tzL3NlYyIsIGZsb2F0NjQodG90YWxVcGRhdGVkKS9lbGFwc2VkLlNlY29uZHMoKSkKCX0KCWxvZy5QcmludGYoIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iKQoKCWlmICpkcnlSdW4gewoJCWxvZy5QcmludGYoIkRSWSBSVU4gTU9ERSAtIE5vIGNoYW5nZXMgd2VyZSBtYWRlIHRvIHRoZSBkYXRhYmFzZSIpCgl9Cn0KCmZ1bmMgYmF0Y2hVcGRhdGVCbG9ja3MoY3R4IGNvbnRleHQuQ29udGV4dCwgZGIgKnNxbC5EQiwgdXBkYXRlcyBbXUJsb2NrVXBkYXRlKSAoaW50LCBbXWludDY0KSB7CglpZiBsZW4odXBkYXRlcykgPT0gMCB7CgkJcmV0dXJuIDAsIG5pbAoJfQoKCWNvbnN0IG1heENhc2VDb25kaXRpb25zID0gNTAKCXRvdGFsVXBkYXRlZCA6PSAwCgl2YXIgc3VjY2Vzc0Jsb2NrcyBbXWludDY0CgoJLy8gUHJvY2VzcyBpbiBjaHVua3MKCWZvciBjaHVua1N0YXJ0IDo9IDA7IGNodW5rU3RhcnQgPCBsZW4odXBkYXRlcyk7IGNodW5rU3RhcnQgKz0gbWF4Q2FzZUNvbmRpdGlvbnMgewoJCWNodW5rRW5kIDo9IGNodW5rU3RhcnQgKyBtYXhDYXNlQ29uZGl0aW9ucwoJCWlmIGNodW5rRW5kID4gbGVuKHVwZGF0ZXMpIHsKCQkJY2h1bmtFbmQgPSBsZW4odXBkYXRlcykKCQl9CgkJY2h1bmsgOj0gdXBkYXRlc1tjaHVua1N0YXJ0OmNodW5rRW5kXQoKCQkvLyBDaGVjayBpZiB3ZSBuZWVkIHRvIHBhdXNlIGZvciBjb21wYWN0aW9uCgkJdmVyc2lvbkVycm9yTXUuTG9jaygpCgkJaWYgdmVyc2lvbkVycm9yQ291bnQgPiAwICYmIHRpbWUuU2luY2UobGFzdENvbXBhY3RUaW1lKSA8IDMqdGltZS5NaW51dGUgewoJCQl2ZXJzaW9uRXJyb3JNdS5VbmxvY2soKQoJCQkvLyBQYXVzZSB0byBsZXQgU3RhclJvY2tzIGNvbXBhY3QKCQkJc2xlZXBUaW1lIDo9IDMqdGltZS5NaW51dGUgLSB0aW1lLlNpbmNlKGxhc3RDb21wYWN0VGltZSkKCQkJbG9nLlByaW50ZigiVG9vIG1hbnkgdmVyc2lvbiBlcnJvcnMgLSBwYXVzaW5nICV2IGZvciBTdGFyUm9ja3MgY29tcGFjdGlvbi4uLiIsIHNsZWVwVGltZSkKCQkJdGltZS5TbGVlcChzbGVlcFRpbWUpCgkJCXZlcnNpb25FcnJvck11LkxvY2soKQoJCQl2ZXJzaW9uRXJyb3JDb3VudCA9IDAKCQkJbGFzdENvbXBhY3RUaW1lID0gdGltZS5Ob3coKQoJCQl2ZXJzaW9uRXJyb3JNdS5VbmxvY2soKQoJCX0gZWxzZSB7CgkJCXZlcnNpb25FcnJvck11LlVubG9jaygpCgkJfQoKCQl2YXIgY2FzZVBhcnRzIFtdc3RyaW5nCgkJdmFyIG51bWJlckxpc3QgW11zdHJpbmcKCQl2YXIgY2h1bmtCbG9ja051bXMgW11pbnQ2NAoKCQlmb3IgXywgdXBkYXRlIDo9IHJhbmdlIGNodW5rIHsKCQkJY2FzZVBhcnRzID0gYXBwZW5kKGNhc2VQYXJ0cywgZm10LlNwcmludGYoIldIRU4gJWQgVEhFTiAlZCIsIHVwZGF0ZS5OdW1iZXIsIHVwZGF0ZS5UaW1lc3RhbXApKQoJCQludW1iZXJMaXN0ID0gYXBwZW5kKG51bWJlckxpc3QsIGZtdC5TcHJpbnRmKCIlZCIsIHVwZGF0ZS5OdW1iZXIpKQoJCQljaHVua0Jsb2NrTnVtcyA9IGFwcGVuZChjaHVua0Jsb2NrTnVtcywgdXBkYXRlLk51bWJlcikKCQl9CgoJCXF1ZXJ5IDo9IGZtdC5TcHJpbnRmKGBVUERBVEUgYmxvY2tzCgkJCVNFVCB0aW1lc3RhbXAgPSBDQVNFIG51bWJlcgoJCQkJJXMKCQkJRU5ECgkJCVdIRVJFIG51bWJlciBJTiAoJXMpYCwKCQkJc3RyaW5ncy5Kb2luKGNhc2VQYXJ0cywgIiAiKSwKCQkJc3RyaW5ncy5Kb2luKG51bWJlckxpc3QsICIsIikpCgoJCXJlc3VsdCwgZXJyIDo9IGRiLkV4ZWNDb250ZXh0KGN0eCwgcXVlcnkpCgkJaWYgZXJyICE9IG5pbCB7CgkJCWlmIHN0cmluZ3MuQ29udGFpbnMoZXJyLkVycm9yKCksICJ0b28gbWFueSB2ZXJzaW9ucyIpIHsKCQkJCWxvZy5QcmludGYoIlZlcnNpb24gbGltaXQgaGl0IC0gd2lsbCBwYXVzZSBhZnRlciB0aGlzIGJhdGNoIikKCQkJCXZlcnNpb25FcnJvck11LkxvY2soKQoJCQkJdmVyc2lvbkVycm9yQ291bnQrKwoJCQkJdmVyc2lvbkVycm9yTXUuVW5sb2NrKCkKCQkJfSBlbHNlIHsKCQkJCWxvZy5QcmludGYoIkVycm9yIHVwZGF0aW5nIGNodW5rIG9mICVkIGJsb2NrczogJXYiLCBsZW4oY2h1bmspLCBlcnIpCgkJCX0KCQkJLy8gRG9uJ3QgbWFyayBhcyBzdWNjZXNzIGlmIGVycm9yCgkJCXRpbWUuU2xlZXAoMiAqIHRpbWUuU2Vjb25kKSAvLyBMb25nZXIgcGF1c2Ugb24gZXJyb3IKCQkJY29udGludWUKCQl9CgoJCXJvd3MsIF8gOj0gcmVzdWx0LlJvd3NBZmZlY3RlZCgpCgkJdG90YWxVcGRhdGVkICs9IGludChyb3dzKQoJCXN1Y2Nlc3NCbG9ja3MgPSBhcHBlbmQoc3VjY2Vzc0Jsb2NrcywgY2h1bmtCbG9ja051bXMuLi4pCgoJCS8vIERlbGF5IGJldHdlZW4gY2h1bmtzIC0gbG9uZ2VyIGRlbGF5IHRvIGF2b2lkIHZlcnNpb24gZXJyb3JzCgkJdGltZS5TbGVlcCg1MDAgKiB0aW1lLk1pbGxpc2Vjb25kKQoJfQoKCXJldHVybiB0b3RhbFVwZGF0ZWQsIHN1Y2Nlc3NCbG9ja3MKfQoKZnVuYyBmZXRjaEJsb2NrVGltZXN0YW1wKGNsaWVudCAqaHR0cC5DbGllbnQsIHJwY1VSTCBzdHJpbmcsIGJsb2NrTnVtIGludDY0KSAoaW50NjQsIHN0cmluZywgZXJyb3IpIHsKCWJsb2NrSGV4IDo9IGZtdC5TcHJpbnRmKCIweCV4IiwgYmxvY2tOdW0pCgoJcmVxQm9keSA6PSBSUENSZXF1ZXN0ewoJCUpTT05SUEM6ICIyLjAiLAoJCU1ldGhvZDogICJldGhfZ2V0QmxvY2tCeU51bWJlciIsCgkJUGFyYW1zOiAgW11pbnRlcmZhY2V7fXtibG9ja0hleCwgZmFsc2V9LAoJCUlEOiAgICAgIDEsCgl9CgoJcmVxQnl0ZXMsIGVyciA6PSBqc29uLk1hcnNoYWwocmVxQm9keSkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiAwLCAiIiwgZm10LkVycm9yZigiZmFpbGVkIHRvIG1hcnNoYWwgcmVxdWVzdDogJXciLCBlcnIpCgl9CgoJcmVzcCwgZXJyIDo9IGNsaWVudC5Qb3N0KHJwY1VSTCwgImFwcGxpY2F0aW9uL2pzb24iLCBieXRlcy5OZXdSZWFkZXIocmVxQnl0ZXMpKQoJaWYgZXJyICE9IG5pbCB7CgkJcmV0dXJuIDAsICIiLCBmbXQuRXJyb3JmKCJIVFRQIHJlcXVlc3QgZmFpbGVkOiAldyIsIGVycikKCX0KCWRlZmVyIHJlc3AuQm9keS5DbG9zZSgpCgoJaWYgcmVzcC5TdGF0dXNDb2RlICE9IGh0dHAuU3RhdHVzT0sgewoJCXJldHVybiAwLCAiIiwgZm10LkVycm9yZigiSFRUUCBzdGF0dXM6ICVkIiwgcmVzcC5TdGF0dXNDb2RlKQoJfQoKCWJvZHksIGVyciA6PSBpby5SZWFkQWxsKHJlc3AuQm9keSkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiAwLCAiIiwgZm10LkVycm9yZigiZmFpbGVkIHRvIHJlYWQgcmVzcG9uc2U6ICV3IiwgZXJyKQoJfQoKCXZhciBycGNSZXNwIFJQQ1Jlc3BvbnNlCglpZiBlcnIgOj0ganNvbi5Vbm1hcnNoYWwoYm9keSwgJnJwY1Jlc3ApOyBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gMCwgIiIsIGZtdC5FcnJvcmYoImZhaWxlZCB0byBwYXJzZSByZXNwb25zZTogJXciLCBlcnIpCgl9CgoJaWYgcnBjUmVzcC5FcnJvciAhPSBuaWwgewoJCXJldHVybiAwLCAiIiwgZm10LkVycm9yZigiUlBDIGVycm9yOiAlcyIsIHJwY1Jlc3AuRXJyb3IuTWVzc2FnZSkKCX0KCgl2YXIgYmxvY2sgQmxvY2tSZXN1bHQKCWlmIGVyciA6PSBqc29uLlVubWFyc2hhbChycGNSZXNwLlJlc3VsdCwgJmJsb2NrKTsgZXJyICE9IG5pbCB7CgkJcmV0dXJuIDAsICIiLCBmbXQuRXJyb3JmKCJmYWlsZWQgdG8gcGFyc2UgYmxvY2s6ICV3IiwgZXJyKQoJfQoKCWlmIGJsb2NrLlRpbWVzdGFtcCA9PSAiIiB7CgkJcmV0dXJuIDAsICIiLCBmbXQuRXJyb3JmKCJibG9jayAlZCBkb2VzIG5vdCBleGlzdCIsIGJsb2NrTnVtKQoJfQoKCXRpbWVzdGFtcEhleCA6PSBzdHJpbmdzLlRyaW1QcmVmaXgoYmxvY2suVGltZXN0YW1wLCAiMHgiKQoJdGltZXN0YW1wLCBlcnIgOj0gc3RyY29udi5QYXJzZUludCh0aW1lc3RhbXBIZXgsIDE2LCA2NCkKCWlmIGVyciAhPSBuaWwgewoJCXJldHVybiAwLCAiIiwgZm10LkVycm9yZigiZmFpbGVkIHRvIHBhcnNlIHRpbWVzdGFtcDogJXciLCBlcnIpCgl9CgoJcmV0dXJuIHRpbWVzdGFtcCwgYmxvY2suSGFzaCwgbmlsCn0K' | base64 -d > main.go
          echo 'module fix' > go.mod
          echo 'go 1.21' >> go.mod  
          echo 'require github.com/go-sql-driver/mysql v1.7.1' >> go.mod
          go mod tidy && go build -o fix main.go
          ./fix --dsn="root:4NbvoV1yw0ONZpzd4DHSVGWE2oeBTReiTaDfDsvLvSgH7v7bl9MQib9fgyeVCjZB@tcp(starrocks-cluster-fe-service.starrocks.svc.cluster.local:9030)/mev_commit_8855?parseTime=true&interpolateParams=true" --workers=15 --batch-size=1000
        resources:
          requests:
            memory: "2Gi"
            cpu: "2000m"
          limits:
            memory: "8Gi"
            cpu: "4000m"
